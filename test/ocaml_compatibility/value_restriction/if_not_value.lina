(* Value restriction: if expression is NOT a syntactic value *)
(* Expected: REJECT - if is not a value, 'a -> 'a is invariant *)

let cond = true

(* If expression is NOT a syntactic value *)
let f = if cond then (fun x -> x) else (fun x -> x)

(* 'a -> 'a is invariant (contravariant + covariant = invariant) *)
(* So relaxed VR doesn't help - this should not be polymorphic *)
let int_result = f 42
let bool_result = f true

let _ = print int_result
