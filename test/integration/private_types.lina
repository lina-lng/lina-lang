-- Test private types
-- Private types cannot be constructed directly but allow pattern matching

-- Module with private type - external code cannot construct values
module M = struct
  type t = private | A | B of int

  -- Internal construction is allowed (within the module that defines it)
  -- Note: This test doesn't actually work yet because we check ALL constructor
  -- uses, including those inside the defining module. This is a limitation.
  -- For now, we just test that pattern matching works on external values.
end

-- Non-private types can be constructed freely
type color = | Red | Green | Blue of int

let red = Red
let green = Green
let blue = Blue 42

let classify_color c = match c with
  | Red -> 1
  | Green -> 2
  | Blue n -> n

let _ = print (classify_color red)
-- Expected: 1

let _ = print (classify_color green)
-- Expected: 2

let _ = print (classify_color blue)
-- Expected: 42
