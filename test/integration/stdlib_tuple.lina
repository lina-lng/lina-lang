(* Test Tuple stdlib module *)

let test name result =
  let _ = print name in
  print (if result then "  PASS" else "  FAIL")

(* Accessors *)
let _ = print "=== Accessors ==="
let pair = (10, 20)
let _ = test "fst" (Tuple.fst pair == 10)
let _ = test "snd" (Tuple.snd pair == 20)

(* Swap *)
let _ = print "=== Swap ==="
let swapped = Tuple.swap (1, 2)
let _ = test "swap fst" (Tuple.fst swapped == 2)
let _ = test "swap snd" (Tuple.snd swapped == 1)
let _ = test "double swap" (
  let p = (5, 10) in
  let swapped_twice = Tuple.swap (Tuple.swap p) in
  Tuple.fst swapped_twice == 5 && Tuple.snd swapped_twice == 10
)

(* map_fst, map_snd *)
let _ = print "=== map_fst/map_snd ==="
let p = (5, 10)
let _ = test "map_fst" (Tuple.fst (Tuple.map_fst (fun x -> x * 2) p) == 10)
let _ = test "map_snd" (Tuple.snd (Tuple.map_snd (fun x -> x + 1) p) == 11)

(* map *)
let _ = print "=== map ==="
let doubled = Tuple.map (fun x -> x * 2) (fun y -> y * 3) (3, 4)
let _ = test "map fst" (Tuple.fst doubled == 6)
let _ = test "map snd" (Tuple.snd doubled == 12)

(* fold *)
let _ = print "=== fold ==="
let _ = test "fold add" (Tuple.fold (fun a b -> a + b) (3, 7) == 10)

(* iter *)
let _ = print "=== iter ==="
let counter = ref 0
let _ = Tuple.iter (fun x -> counter := !counter + x) (10, 20)
let _ = test "iter" (!counter == 30)

(* equal *)
let _ = print "=== equal ==="
let int_eq a b = a == b
let _ = test "equal same" (Tuple.equal int_eq int_eq (1, 2) (1, 2))
let _ = test "not equal" (not (Tuple.equal int_eq int_eq (1, 2) (1, 3)))

(* compare *)
let _ = print "=== compare ==="
let int_cmp a b = if a < b then 0 - 1 else if a > b then 1 else 0
let _ = test "compare equal" (Tuple.compare int_cmp int_cmp (1, 2) (1, 2) == 0)
let _ = test "compare less by fst" (Tuple.compare int_cmp int_cmp (1, 5) (2, 0) < 0)
let _ = test "compare less by snd" (Tuple.compare int_cmp int_cmp (1, 2) (1, 3) < 0)

(* to_list *)
let _ = print "=== to_list ==="
let lst = Tuple.to_list (1, 2)
let _ = test "to_list length" (List.length lst == 2)
let first_elem = match List.head lst with Some x -> x | None -> 0
let _ = test "to_list first" (first_elem == 1)

(* Edge cases *)
let _ = print "=== Edge Cases ==="
let nested = ((1, 2), (3, 4))
let _ = test "nested fst" (Tuple.fst (Tuple.fst nested) == 1)

let _ = print "=== All Tuple tests completed ==="
